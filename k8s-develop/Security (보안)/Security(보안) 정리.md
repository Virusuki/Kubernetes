# Security Context
컨테이너 내부에 있는 프로세스의 권한 정책을 결정한다.
user같은 경우 root권한을 가지지 않아야 한다. 서버에 로그인할 때 일반적으로 일반 사용자가 들어와서 작업할 수 있도록 해야 한다.
일반적인 실무에서는 root를 권장하지 않는다. 가능한 sudo로 권한을 사용해야 한다.

- 서버 침해사고 발생 시, 침해사고를 당한 권한을 최대한 축소해 그 사고에 대한 확대를 방지 (일반 사용자의 권한을 준다.)   
  - 쿠버네티스에는 어떻게 공격들이 일어날까?
    - 쿠버네티스 아키텍처는 굉장히 복잡하고, 수 많은 애플리케이션들이 동작한다. 그 중 하나의 애플리케이션이 취약점이 약해 뚫릴 경우 컨테이너는 탈취를 당한다면,
      내부적으로 전파될 risk가 있다. 쿠버네티스의 권한을 탈취되는 도미너 방식의 문제가 발생될 risk가 있다.


- 최소 권한 정책에 따른 취약점 감소
- 보안 컨텍스트 설정에는 다음 사항을 포함한다.
  - 권한 상승 가능 여부 (Previleged 막강한 권한이 있음)

  - 프로세스 기본 UID/GID를 활용한 파일 등의 오브젝트 엑세스 제어

  - Linux Capabilities를 활용한 커널 기능 추가
    - (예:중간에 엠베서더를 장착해서 보안을 강화시켜야 한다.)


# 네트워크 정책 
- 파드 그룹이 서로 간 또는 다른 네트워크 endpoint와 통신하는 방법을 지정한다.
- Networkpolicy 리소스는 레이블을 사용하여 Pod를 선택한다.
- 선택한 Pod에 허용되는 트래픽을 지정하는 규칙을 정의한다.
- 특정 Pod를 선택하는 namespace에 NetworkPolicy가 있으면 해당 Pod는 NetworkPolicy에서 허용하지 않는 연결을 거부한다.


# 쿠버네티스 감사(Audit) 기능 활성화
사용자를 감지하는 역할이다.
책임자를 찾는 것이 감사의 역할이라고도 할 수 있다.



# Trivy를 활용한 컨테이너 취약점 진단
컨테이너 취약점을 진단하거나, trivy를 사용하면 컨테이너 상에 취약 진단, 도커 설정에 진단, 쿠버네티스 설정 또한 진단할 수 있따.




# kube-bench
아직까지 쿠버네티스의 인증과정은 없다. 해외에서는 기준을 제시하고 있음.
CIS쪽에서 제공해주는 benchmark가 있다.
CIS는 국제 표준을 따른다.





# falco를 활용한 쿠버네티스 컨테이너 보안 모니터링
flaco는 컨테이너를 모니터링 역할을 한다. (컨테이너안에서 이상활동이 있으면 그것을 탐지하는 falco의 역할이다.)


